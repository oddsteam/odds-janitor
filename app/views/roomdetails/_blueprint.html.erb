<!-- app/views/rooms/_blueprint.html.erb -->
<div>
  <div class="relative w-auto h-auto">
    <%= image_tag "blueprint.svg", alt: "Blueprint", width: 2500, height: 1500, class: "cursor-zoom-in relative top-0 left-0 w-full h-full object-cover z-10", onclick: "handleImageClick()" %>
    <svg viewBox="0 0 2500 1500" class="absolute top-0 left-0 w-full h-full object-cover z-0" onclick="handleImageClick()">
      <% @mock_data_room.each do |room| %>
        <rect
          name="<%= room[:name] %>"
          x="<%= room[:x] %>"
          y="<%= room[:y] %>"
          width="<%= room[:width] %>"
          height="<%= room[:height] %>"
          fill="<%= @selected_room_id == room[:id] ? 'rgb(96 165 250)' : 'rgb(245 245 245)' %>"
        />
        <text
          x="<%= room[:x] + room[:width] / 2 %>"
          y="<%= room[:y] + room[:height] / 2 %>"
          fill="<%= @selected_room_id == room[:id] ? '#FFFFFF' : '#000000' %>"
          textAnchor="middle"
          alignmentBaseline="middle"
          fontSize="28"
          fontWeight="bold"
        >
          <%= room[:name] %>
        </text>
      <% end %>
    </svg>
  </div>

  <div id="modal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-75 hidden">
    <div class="relative bg-white p-16 items-center rounded-3xl transition-transform duration-300" id="modal-content">
      <%= image_tag "blueprint.svg", width: 1000, height: 500, alt: "Blueprint", class: "relative object-contain z-10" %>
      <svg viewBox="0 0 2500 1500" class="p-16 absolute top-0 left-0 w-full h-full object-contain z-0">
        <% @mock_data_room.each do |room| %>
          <rect
            name="<%= room[:name] %>"
            x="<%= room[:x] %>"
            y="<%= room[:y] %>"
            width="<%= room[:width] %>"
            height="<%= room[:height] %>"
            fill="<%= @selected_room_id == room[:id] ? 'rgb(96 165 250)' : 'rgb(245 245 245)' %>"
          />
          <text
            x="<%= room[:x] + room[:width] / 2 %>"
            y="<%= room[:y] + room[:height] / 2 %>"
            fill="<%= @selected_room_id == room[:id] ? '#FFFFFF' : '#000000' %>"
            textAnchor="middle"
            alignmentBaseline="middle"
            fontSize="28"
            fontWeight="bold"
          >
            <%= room[:name] %>
          </text>
        <% end %>
      </svg>
      <button class="absolute top-2 right-2 text-black text-4xl" onclick="handleClose()">&times;</button>
    </div>
  </div>
</div>

<script>
  var isOpen = false;
  var isZoomed = false;

  function handleImageClick() {
    isOpen = true;
    isZoomed = !isZoomed;
    document.getElementById('modal').classList.remove('hidden');
  }

  function handleClose() {
    isOpen = false;
    document.getElementById('modal').classList.add('hidden');
  }
</script>
